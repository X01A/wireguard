---
- include: dependencies/{{ ansible_distribution | lower }}.yml
  tags:
    - install
    - deps
  when: ansible_local.wireguard is not defined

- name: Flush deps handler
  meta: flush_handlers

- name: Add wireguard module
  modprobe:
    name: wireguard
    state: present

- import_tasks: assert.yml
  tags:
    - check
  when: test_mode is defined

- import_tasks: config.yml
  tags:
    - config
